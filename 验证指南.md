# YOLOv8 æ¨¡å‹éªŒè¯æŒ‡å—

## ğŸ“š ç›®å½•

1. [éªŒè¯æ¦‚è¿°](#éªŒè¯æ¦‚è¿°)
2. [è®­ç»ƒåéªŒè¯](#è®­ç»ƒåéªŒè¯)
3. [ç‹¬ç«‹éªŒè¯](#ç‹¬ç«‹éªŒè¯)
4. [éªŒè¯å‚æ•°](#éªŒè¯å‚æ•°)
5. [éªŒè¯ç»“æœè§£è¯»](#éªŒè¯ç»“æœè§£è¯»)
6. [éªŒè¯ç¤ºä¾‹](#éªŒè¯ç¤ºä¾‹)

---

## ğŸ¯ éªŒè¯æ¦‚è¿°

æ¨¡å‹éªŒè¯ç”¨äºè¯„ä¼°è®­ç»ƒå¥½çš„æ¨¡å‹åœ¨éªŒè¯é›†ä¸Šçš„æ€§èƒ½ï¼Œä¸»è¦æŒ‡æ ‡åŒ…æ‹¬ï¼š
- **ç²¾åº¦ (Precision)**: é¢„æµ‹ä¸ºæ­£ä¾‹ä¸­çœŸæ­£ä¸ºæ­£ä¾‹çš„æ¯”ä¾‹
- **å¬å›ç‡ (Recall)**: çœŸæ­£ä¾‹ä¸­è¢«æ­£ç¡®é¢„æµ‹çš„æ¯”ä¾‹
- **mAP@0.5**: åœ¨ IoU=0.5 æ—¶çš„å¹³å‡ç²¾åº¦
- **mAP@0.5:0.95**: åœ¨ IoU ä» 0.5 åˆ° 0.95 çš„å¹³å‡ç²¾åº¦

---

## âœ… è®­ç»ƒåéªŒè¯

### æ–¹æ³•ä¸€ï¼šè®­ç»ƒè¿‡ç¨‹ä¸­è‡ªåŠ¨éªŒè¯

è®­ç»ƒæ—¶ï¼ŒYOLOv8 é»˜è®¤ä¼šåœ¨æ¯ä¸ª epoch ç»“æŸåè‡ªåŠ¨åœ¨éªŒè¯é›†ä¸ŠéªŒè¯ï¼š

```python
from ultralytics import YOLO

model = YOLO("yolov8n.pt")
model.train(
    data="coco128.yaml",
    epochs=100,
    val=True  # é»˜è®¤å¼€å¯ï¼Œæ¯ä¸ª epoch åéªŒè¯
)
```

### æ–¹æ³•äºŒï¼šè®­ç»ƒåç«‹å³éªŒè¯

è®­ç»ƒå®Œæˆåï¼Œæ¨¡å‹å¯¹è±¡ä¼šè®°ä½è®­ç»ƒæ—¶çš„æ•°æ®é›†é…ç½®ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ `val()`ï¼š

```python
from ultralytics import YOLO

# è®­ç»ƒæ¨¡å‹
model = YOLO("yolov8n.pt")
model.train(data="coco128.yaml", epochs=100)

# è®­ç»ƒåç«‹å³éªŒè¯ï¼ˆæ— éœ€æŒ‡å®šæ•°æ®é›†ï¼Œä¼šè‡ªåŠ¨ä½¿ç”¨è®­ç»ƒæ—¶çš„æ•°æ®é›†ï¼‰
results = model.val()
```

---

## ğŸ” ç‹¬ç«‹éªŒè¯

### å‘½ä»¤è¡ŒéªŒè¯ï¼ˆCLIï¼‰

#### åŸºç¡€éªŒè¯

```bash
# éªŒè¯è®­ç»ƒå¥½çš„æ¨¡å‹ï¼ˆä¼šè‡ªåŠ¨ä½¿ç”¨æ¨¡å‹ä¿å­˜çš„æ•°æ®é›†é…ç½®ï¼‰
yolo detect val model=runs/detect/train/weights/best.pt

# æˆ–æŒ‡å®šæ•°æ®é›†
yolo detect val model=runs/detect/train/weights/best.pt data=coco128.yaml
```

#### å®Œæ•´éªŒè¯å‘½ä»¤

```bash
yolo detect val \
    model=runs/detect/train/weights/best.pt \
    data=coco128.yaml \
    imgsz=640 \
    batch=16 \
    conf=0.001 \
    iou=0.7 \
    device=0 \
    plots=True \
    save_json=True
```

### Python API éªŒè¯

#### åŸºç¡€éªŒè¯

```python
from ultralytics import YOLO

# åŠ è½½è®­ç»ƒå¥½çš„æ¨¡å‹
model = YOLO("runs/detect/train/weights/best.pt")

# éªŒè¯ï¼ˆä½¿ç”¨æ¨¡å‹ä¿å­˜çš„æ•°æ®é›†é…ç½®ï¼‰
results = model.val()
```

#### æŒ‡å®šæ•°æ®é›†éªŒè¯

```python
from ultralytics import YOLO

# åŠ è½½æ¨¡å‹
model = YOLO("runs/detect/train/weights/best.pt")

# ä½¿ç”¨æŒ‡å®šçš„æ•°æ®é›†éªŒè¯
results = model.val(data="coco128.yaml")
```

#### å®Œæ•´éªŒè¯é…ç½®

```python
from ultralytics import YOLO

# åŠ è½½æ¨¡å‹
model = YOLO("runs/detect/train/weights/best.pt")

# å®Œæ•´éªŒè¯é…ç½®
results = model.val(
    data="coco128.yaml",  # æ•°æ®é›†é…ç½®
    imgsz=640,            # å›¾åƒå°ºå¯¸
    batch=16,              # æ‰¹æ¬¡å¤§å°
    conf=0.001,           # ç½®ä¿¡åº¦é˜ˆå€¼ï¼ˆéªŒè¯æ—¶é€šå¸¸è¾ƒä½ï¼‰
    iou=0.7,               # IoU é˜ˆå€¼
    device=0,              # è®¾å¤‡
    plots=True,            # ç”Ÿæˆå›¾è¡¨
    save_json=True,        # ä¿å­˜ JSON ç»“æœ
    save_hybrid=False,     # ä¿å­˜æ··åˆæ ‡ç­¾
    half=False,            # ä½¿ç”¨åŠç²¾åº¦
    verbose=True           # è¯¦ç»†è¾“å‡º
)
```

---

## âš™ï¸ éªŒè¯å‚æ•°è¯¦è§£

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ | ç¤ºä¾‹ |
|------|------|--------|------|
| `data` | æ•°æ®é›†é…ç½®æ–‡ä»¶è·¯å¾„ | æ¨¡å‹ä¿å­˜çš„é…ç½® | `data=coco128.yaml` |
| `imgsz` | å›¾åƒå°ºå¯¸ | è®­ç»ƒæ—¶çš„å°ºå¯¸ | `imgsz=640` |
| `batch` | æ‰¹æ¬¡å¤§å° | 16 | `batch=32` |
| `conf` | ç½®ä¿¡åº¦é˜ˆå€¼ | 0.001ï¼ˆéªŒè¯ï¼‰ | `conf=0.25`ï¼ˆé¢„æµ‹ï¼‰ |
| `iou` | IoU é˜ˆå€¼ï¼ˆNMSï¼‰ | 0.7 | `iou=0.5` |
| `max_det` | æ¯å¼ å›¾æœ€å¤§æ£€æµ‹æ•° | 300 | `max_det=100` |
| `device` | è®¾å¤‡ | - | `device=0` æˆ– `device=cpu` |
| `plots` | ç”Ÿæˆå›¾è¡¨ | True | `plots=True` |
| `save_json` | ä¿å­˜ JSON ç»“æœ | False | `save_json=True` |
| `save_hybrid` | ä¿å­˜æ··åˆæ ‡ç­¾ | False | `save_hybrid=False` |
| `half` | åŠç²¾åº¦æ¨ç† | False | `half=True` |
| `verbose` | è¯¦ç»†è¾“å‡º | True | `verbose=True` |

### é‡è¦å‚æ•°è¯´æ˜

- **conf (ç½®ä¿¡åº¦é˜ˆå€¼)**:
  - éªŒè¯æ—¶é€šå¸¸è®¾ä¸º `0.001`ï¼ˆæ›´å®½æ¾ï¼Œè¯„ä¼°æ‰€æœ‰å¯èƒ½çš„æ£€æµ‹ï¼‰
  - é¢„æµ‹æ—¶é€šå¸¸è®¾ä¸º `0.25`ï¼ˆè¿‡æ»¤ä½ç½®ä¿¡åº¦æ£€æµ‹ï¼‰

- **iou (IoU é˜ˆå€¼)**:
  - ç”¨äºéæå¤§å€¼æŠ‘åˆ¶ï¼ˆNMSï¼‰
  - é€šå¸¸è®¾ä¸º `0.5` æˆ– `0.7`

---

## ğŸ“Š éªŒè¯ç»“æœè§£è¯»

### éªŒè¯è¾“å‡ºç¤ºä¾‹

```
Ultralytics YOLOv8.0.29 ğŸš€ Python-3.8.10 torch-2.4.1 CUDA:0 (Tesla T4, 15110MiB)
YOLOv8n summary (fused): 168 layers, 3151904 parameters, 0 gradients, 8.7 GFLOPs

val: Scanning /path/to/dataset/labels/val... 100 images, 0 backgrounds, 0 corrupt: 100% 100/100 [00:00<00:00, 500.00it/s]
val: New cache created: /path/to/dataset/labels/val.cache

                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 7/7 [00:05<00:00,  1.40it/s]
                   all        100        500       0.850      0.820      0.880      0.650
                person        100        200      0.900      0.850      0.920      0.700
                   car        100        150      0.800      0.790      0.840      0.600
```

### æŒ‡æ ‡è¯´æ˜

- **Class**: ç±»åˆ«åç§°
- **Images**: éªŒè¯å›¾åƒæ•°é‡
- **Instances**: ç›®æ ‡å®ä¾‹æ•°é‡
- **Box(P)**: è¾¹ç•Œæ¡†ç²¾åº¦ (Precision)
- **R**: å¬å›ç‡ (Recall)
- **mAP50**: mAP@0.5ï¼ˆIoU=0.5 æ—¶çš„å¹³å‡ç²¾åº¦ï¼‰
- **mAP50-95**: mAP@0.5:0.95ï¼ˆIoU ä» 0.5 åˆ° 0.95 çš„å¹³å‡ç²¾åº¦ï¼‰

### ç»“æœæ–‡ä»¶

éªŒè¯ç»“æœä¿å­˜åœ¨ `runs/detect/val/` ç›®å½•ä¸‹ï¼š

```
runs/detect/val/
â”œâ”€â”€ args.yaml              # éªŒè¯å‚æ•°
â”œâ”€â”€ results.csv            # éªŒè¯ç»“æœ CSV
â”œâ”€â”€ confusion_matrix.png   # æ··æ·†çŸ©é˜µ
â”œâ”€â”€ F1_curve.png          # F1 æ›²çº¿
â”œâ”€â”€ P_curve.png           # ç²¾åº¦æ›²çº¿
â”œâ”€â”€ PR_curve.png          # PR æ›²çº¿
â”œâ”€â”€ R_curve.png           # å¬å›ç‡æ›²çº¿
â””â”€â”€ predictions/          # é¢„æµ‹ç»“æœå›¾åƒ
    â”œâ”€â”€ image1.jpg
    â””â”€â”€ ...
```

---

## ğŸ’¡ éªŒè¯ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šè®­ç»ƒåç«‹å³éªŒè¯

```python
from ultralytics import YOLO

# è®­ç»ƒæ¨¡å‹
model = YOLO("yolov8n.pt")
model.train(data="coco128.yaml", epochs=100)

# è®­ç»ƒåéªŒè¯
results = model.val()
print(f"mAP50: {results.results_dict.get('metrics/mAP50(B)', 'N/A')}")
```

### ç¤ºä¾‹ 2ï¼šåŠ è½½æ¨¡å‹éªŒè¯

```python
from ultralytics import YOLO

# åŠ è½½è®­ç»ƒå¥½çš„æ¨¡å‹
model = YOLO("runs/detect/train/weights/best.pt")

# éªŒè¯
results = model.val(data="coco128.yaml")
```

### ç¤ºä¾‹ 3ï¼šéªŒè¯å¤šä¸ªæ¨¡å‹

```python
from ultralytics import YOLO

models = [
    "runs/detect/train1/weights/best.pt",
    "runs/detect/train2/weights/best.pt",
    "runs/detect/train3/weights/best.pt"
]

for model_path in models:
    print(f"\néªŒè¯æ¨¡å‹: {model_path}")
    model = YOLO(model_path)
    results = model.val(data="coco128.yaml")
    print(f"mAP50: {results.results_dict.get('metrics/mAP50(B)', 'N/A')}")
```

### ç¤ºä¾‹ 4ï¼šè‡ªå®šä¹‰éªŒè¯é…ç½®

```python
from ultralytics import YOLO

model = YOLO("runs/detect/train/weights/best.pt")

# è‡ªå®šä¹‰éªŒè¯é…ç½®
results = model.val(
    data="coco128.yaml",
    imgsz=640,
    batch=32,
    conf=0.001,      # éªŒè¯æ—¶ä½¿ç”¨ä½ç½®ä¿¡åº¦é˜ˆå€¼
    iou=0.7,
    device=0,
    plots=True,      # ç”Ÿæˆæ‰€æœ‰å›¾è¡¨
    save_json=True,  # ä¿å­˜ JSON ç»“æœ
    verbose=True
)
```

### ç¤ºä¾‹ 5ï¼šå‘½ä»¤è¡ŒéªŒè¯

```bash
# åŸºç¡€éªŒè¯
yolo detect val model=runs/detect/train/weights/best.pt

# æŒ‡å®šæ•°æ®é›†
yolo detect val model=runs/detect/train/weights/best.pt data=coco128.yaml

# å®Œæ•´é…ç½®
yolo detect val \
    model=runs/detect/train/weights/best.pt \
    data=coco128.yaml \
    imgsz=640 \
    batch=16 \
    conf=0.001 \
    iou=0.7 \
    plots=True \
    save_json=True
```

---

## ğŸ”§ éªŒè¯è„šæœ¬ç¤ºä¾‹

åˆ›å»ºä¸€ä¸ªéªŒè¯è„šæœ¬ `val_example.py`ï¼š

```python
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
YOLOv8 éªŒè¯ç¤ºä¾‹è„šæœ¬
"""

from ultralytics import YOLO
import argparse


def validate_model(model_path, data=None, imgsz=640, batch=16, 
                   conf=0.001, iou=0.7, device=0, plots=True):
    """
    éªŒè¯ YOLOv8 æ¨¡å‹
    
    å‚æ•°:
        model_path: æ¨¡å‹æ–‡ä»¶è·¯å¾„
        data: æ•°æ®é›†é…ç½®æ–‡ä»¶ï¼ˆå¯é€‰ï¼Œæ¨¡å‹ä¼šè®°ä½è®­ç»ƒæ—¶çš„é…ç½®ï¼‰
        imgsz: å›¾åƒå°ºå¯¸
        batch: æ‰¹æ¬¡å¤§å°
        conf: ç½®ä¿¡åº¦é˜ˆå€¼
        iou: IoU é˜ˆå€¼
        device: è®¾å¤‡
        plots: æ˜¯å¦ç”Ÿæˆå›¾è¡¨
    """
    print(f"ğŸ” å¼€å§‹éªŒè¯æ¨¡å‹")
    print(f"ğŸ¤– æ¨¡å‹: {model_path}")
    print(f"ğŸ“¦ æ•°æ®é›†: {data or 'ä½¿ç”¨æ¨¡å‹ä¿å­˜çš„é…ç½®'}")
    print(f"ğŸ“ å›¾åƒå°ºå¯¸: {imgsz}")
    print(f"ğŸ“Š æ‰¹æ¬¡å¤§å°: {batch}")
    print(f"ğŸ¯ ç½®ä¿¡åº¦é˜ˆå€¼: {conf}")
    print(f"ğŸ“ IoU é˜ˆå€¼: {iou}")
    print("-" * 50)
    
    # åŠ è½½æ¨¡å‹
    print(f"ğŸ“¥ åŠ è½½æ¨¡å‹...")
    model = YOLO(model_path)
    
    # éªŒè¯
    print(f"ğŸ” å¼€å§‹éªŒè¯...")
    kwargs = {
        'imgsz': imgsz,
        'batch': batch,
        'conf': conf,
        'iou': iou,
        'device': device,
        'plots': plots,
        'verbose': True
    }
    
    if data:
        kwargs['data'] = data
    
    results = model.val(**kwargs)
    
    print("-" * 50)
    print("âœ… éªŒè¯å®Œæˆï¼")
    
    # æ˜¾ç¤ºå…³é”®æŒ‡æ ‡
    if hasattr(results, 'results_dict'):
        metrics = results.results_dict
        print(f"\nğŸ“Š éªŒè¯æŒ‡æ ‡:")
        print(f"   mAP50: {metrics.get('metrics/mAP50(B)', 'N/A'):.4f}")
        print(f"   mAP50-95: {metrics.get('metrics/mAP50-95(B)', 'N/A'):.4f}")
        print(f"   ç²¾åº¦ (P): {metrics.get('metrics/precision(B)', 'N/A'):.4f}")
        print(f"   å¬å›ç‡ (R): {metrics.get('metrics/recall(B)', 'N/A'):.4f}")
    
    return results


def main():
    parser = argparse.ArgumentParser(description="YOLOv8 éªŒè¯è„šæœ¬")
    parser.add_argument("--model", type=str, required=True,
                       help="æ¨¡å‹æ–‡ä»¶è·¯å¾„ï¼ˆ.ptï¼‰")
    parser.add_argument("--data", type=str, default=None,
                       help="æ•°æ®é›†é…ç½®æ–‡ä»¶è·¯å¾„ï¼ˆå¯é€‰ï¼‰")
    parser.add_argument("--imgsz", type=int, default=640,
                       help="å›¾åƒå°ºå¯¸")
    parser.add_argument("--batch", type=int, default=16,
                       help="æ‰¹æ¬¡å¤§å°")
    parser.add_argument("--conf", type=float, default=0.001,
                       help="ç½®ä¿¡åº¦é˜ˆå€¼")
    parser.add_argument("--iou", type=float, default=0.7,
                       help="IoU é˜ˆå€¼")
    parser.add_argument("--device", type=str, default="0",
                       help="è®¾å¤‡ï¼ˆ0 è¡¨ç¤º GPU 0ï¼Œ'cpu' è¡¨ç¤º CPUï¼‰")
    parser.add_argument("--plots", action="store_true", default=True,
                       help="ç”Ÿæˆå›¾è¡¨")
    
    args = parser.parse_args()
    
    # è½¬æ¢ device å‚æ•°
    if args.device == "cpu":
        device = "cpu"
    elif args.device.isdigit():
        device = int(args.device)
    else:
        device = args.device
    
    # éªŒè¯æ¨¡å‹
    validate_model(
        model_path=args.model,
        data=args.data,
        imgsz=args.imgsz,
        batch=args.batch,
        conf=args.conf,
        iou=args.iou,
        device=device,
        plots=args.plots
    )


if __name__ == "__main__":
    main()
```

---

## ğŸ“ éªŒè¯æœ€ä½³å®è·µ

1. **ä½¿ç”¨æœ€ä½³æ¨¡å‹**: éªŒè¯æ—¶ä½¿ç”¨ `best.pt` è€Œä¸æ˜¯ `last.pt`
2. **éªŒè¯é›†ç‹¬ç«‹**: ç¡®ä¿éªŒè¯é›†ä¸è®­ç»ƒé›†ä¸é‡å 
3. **ç½®ä¿¡åº¦é˜ˆå€¼**: éªŒè¯æ—¶ä½¿ç”¨ä½é˜ˆå€¼ï¼ˆ0.001ï¼‰ä»¥è¯„ä¼°æ‰€æœ‰æ£€æµ‹
4. **ç”Ÿæˆå›¾è¡¨**: ä½¿ç”¨ `plots=True` ç”Ÿæˆå¯è§†åŒ–ç»“æœ
5. **ä¿å­˜ç»“æœ**: ä½¿ç”¨ `save_json=True` ä¿å­˜è¯¦ç»†ç»“æœ
6. **å¤šæ¬¡éªŒè¯**: åœ¨ä¸åŒæ•°æ®é›†ä¸ŠéªŒè¯ä»¥è¯„ä¼°æ³›åŒ–èƒ½åŠ›

---

## ğŸ¯ å¿«é€Ÿå‚è€ƒ

### æœ€å¸¸ç”¨çš„éªŒè¯å‘½ä»¤

```bash
# å‘½ä»¤è¡ŒéªŒè¯
yolo detect val model=runs/detect/train/weights/best.pt data=coco128.yaml
```

```python
# Python API éªŒè¯
from ultralytics import YOLO

model = YOLO("runs/detect/train/weights/best.pt")
results = model.val(data="coco128.yaml")
```

---

**ç¥æ‚¨éªŒè¯é¡ºåˆ©ï¼** ğŸš€

